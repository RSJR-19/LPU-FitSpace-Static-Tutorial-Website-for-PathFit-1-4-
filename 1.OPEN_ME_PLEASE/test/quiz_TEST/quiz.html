<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Simple Quiz</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background: #f9f9f9;
        }

        .option {
            display: block;
            margin: 8px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background: white;
        }

        .option:hover {
            background: #f0f0f0;
        }

        .correct {
            background: #d4edda !important;
            border-left: 4px solid #28a745;
        }

        .wrong {
            background: #f8d7da !important;
            border-left: 4px solid #dc3545;
        }

        button {
            margin-top: 20px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background: #0056b3;
        }
    </style>
</head>

<body>
    <h1 id="title">Loading Quiz...</h1>
    <div id="quiz"></div>
    <script>
        let questions = [];
        let currentIndex = 0;
        let score = 0;

        // Load quiz from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const quizFile = urlParams.get("quiz");

        // Load and start quiz
        fetch(quizFile)
            .then((response) => response.json())
            .then((data) => {
                questions = data;
                showQuestion();
            })
            .catch((error) => {
                document.getElementById("quiz").innerHTML = `
                    <div style="color:red;">Failed to load quiz. Please try again.</div>
                `;
            });

        // Show current question
        function showQuestion() {
            const question = questions[currentIndex];
            document.getElementById("title").textContent = `Question ${currentIndex + 1}`;
            let html = `<h3>${question.question}</h3>`;
            question.options.forEach((option, index) => {
                html += `<div class="option" onclick="checkAnswer(${index})">${option}</div>`;
            });
            document.getElementById("quiz").innerHTML = html;
        }

        // Check user's answer
        function checkAnswer(selectedIndex) {
            const question = questions[currentIndex];
            const options = document.querySelectorAll(".option");
            options.forEach((option, index) => {
                option.style.pointerEvents = "none"; // Disable clicking
                if (index === question.answer) option.classList.add("correct");
                if (index === selectedIndex && index !== question.answer)
                    option.classList.add("wrong");
            });

            if (selectedIndex === question.answer) score++;

            document.getElementById("quiz").innerHTML += `
                <p><strong>${selectedIndex === question.answer ? "Correct!" : "Wrong!"
                }</strong></p>
                <p>${question.explanation || "No explanation provided."}</p>
                <button onclick="nextQuestion()">Next</button>
            `;
        }

        // Move to next question or show results
        function nextQuestion() {
            currentIndex++;
            if (currentIndex < questions.length) showQuestion();
            else showResults();
        }

        // Show quiz results
        function showResults() {
            const percentage = (score / questions.length) * 100;
            const grade =
                percentage >= 90
                    ? "A"
                    : percentage >= 80
                        ? "B"
                        : percentage >= 70
                            ? "C"
                            : percentage >= 60
                                ? "D"
                                : "F";
            document.getElementById("title").textContent = "Quiz Complete!";
            document.getElementById("quiz").innerHTML = `
                <h2>Your Score: ${score} / ${questions.length}</h2>
                <div class="score-circle">
                    <span class="percentage">${percentage.toFixed(1)}%</span>
                    <span class="grade">Grade: ${grade}</span>
                </div>
                <button onclick="location.reload()">Try Again</button>
            `;
        }

    </script>
</body>

</html>